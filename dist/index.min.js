(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["wx"] = factory();
	else
		root["wx"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

!function (a, b) {
    module.exports = b(a)
}(window, function (a, b) {
    function c(b, c, d) {
        a.WeixinJSBridge ? WeixinJSBridge.invoke(b, e(c), function (a) {
            h(b, a, d)
        }) : k(b, d)
    }

    function d(b, c, d) {
        a.WeixinJSBridge ? WeixinJSBridge.on(b, function (a) {
            d && d.trigger && d.trigger(a), h(b, a, c)
        }) : d ? k(b, d) : k(b, c)
    }

    function e(a) {
        return a = a || {}, a.appId = D.appId, a.verifyAppId = D.appId, a.verifySignType = "sha1", a.verifyTimestamp = D.timestamp + "", a.verifyNonceStr = D.nonceStr, a.verifySignature = D.signature, a
    }

    function f(a) {
        return {
            timeStamp: a.timestamp + "",
            nonceStr: a.nonceStr,
            "package": a["package"],
            paySign: a.paySign,
            signType: a.signType || "SHA1"
        }
    }

    function g(a) {
        return a.postalCode = a.addressPostalCode, delete a.addressPostalCode, a.provinceName = a.proviceFirstStageName, delete a.proviceFirstStageName, a.cityName = a.addressCitySecondStageName, delete a.addressCitySecondStageName, a.countryName = a.addressCountiesThirdStageName, delete a.addressCountiesThirdStageName, a.detailInfo = a.addressDetailInfo, delete a.addressDetailInfo, a
    }

    function h(a, b, c) {
        "openEnterpriseChat" == a && (b.errCode = b.err_code), delete b.err_code, delete b.err_desc, delete b.err_detail;
        var d = b.errMsg;
        d || (d = b.err_msg, delete b.err_msg, d = i(a, d), b.errMsg = d), c = c || {}, c._complete && (c._complete(b), delete c._complete), d = b.errMsg || "", D.debug && !c.isInnerInvoke && alert(JSON.stringify(b));
        var e = d.indexOf(":"), f = d.substring(e + 1);
        switch (f) {
            case"ok":
                c.success && c.success(b);
                break;
            case"cancel":
                c.cancel && c.cancel(b);
                break;
            default:
                c.fail && c.fail(b)
        }
        c.complete && c.complete(b)
    }

    function i(a, b) {
        var c = a, d = q[c];
        d && (c = d);
        var e = "ok";
        if (b) {
            var f = b.indexOf(":");
            e = b.substring(f + 1), "confirm" == e && (e = "ok"), "failed" == e && (e = "fail"), -1 != e.indexOf("failed_") && (e = e.substring(7)), -1 != e.indexOf("fail_") && (e = e.substring(5)), e = e.replace(/_/g, " "), e = e.toLowerCase(), ("access denied" == e || "no permission to execute" == e) && (e = "permission denied"), "config" == c && "function not exist" == e && (e = "ok"), "" == e && (e = "fail")
        }
        return b = c + ":" + e
    }

    function j(a) {
        if (a) {
            for (var b = 0, c = a.length; c > b; ++b) {
                var d = a[b], e = p[d];
                e && (a[b] = e)
            }
            return a
        }
    }

    function k(a, b) {
        if (!(!D.debug || b && b.isInnerInvoke)) {
            var c = q[a];
            c && (a = c), b && b._complete && delete b._complete, console.log('"' + a + '",', b || "")
        }
    }

    function l(a) {
        if (!(v || w || D.debug || "6.0.2" > A || C.systemType < 0)) {
            var b = new Image;
            C.appId = D.appId, C.initTime = B.initEndTime - B.initStartTime, C.preVerifyTime = B.preVerifyEndTime - B.preVerifyStartTime, I.getNetworkType({
                isInnerInvoke: !0,
                success: function (a) {
                    C.networkType = a.networkType;
                    var c = "https://open.weixin.qq.com/sdk/report?v=" + C.version + "&o=" + C.isPreVerifyOk + "&s=" + C.systemType + "&c=" + C.clientVersion + "&a=" + C.appId + "&n=" + C.networkType + "&i=" + C.initTime + "&p=" + C.preVerifyTime + "&u=" + C.url;
                    b.src = c
                }
            })
        }
    }

    function m() {
        return (new Date).getTime()
    }

    function n(b) {
        x && (a.WeixinJSBridge ? b() : r.addEventListener && r.addEventListener("WeixinJSBridgeReady", b, !1))
    }

    function o() {
        I.invoke || (I.invoke = function (b, c, d) {
            a.WeixinJSBridge && WeixinJSBridge.invoke(b, e(c), d)
        }, I.on = function (b, c) {
            a.WeixinJSBridge && WeixinJSBridge.on(b, c)
        })
    }

    if (!a.jWeixin) {
        var p = {
            config: "preVerifyJSAPI",
            onMenuShareTimeline: "menu:share:timeline",
            onMenuShareAppMessage: "menu:share:appmessage",
            onMenuShareQQ: "menu:share:qq",
            onMenuShareWeibo: "menu:share:weiboApp",
            onMenuShareQZone: "menu:share:QZone",
            previewImage: "imagePreview",
            getLocation: "geoLocation",
            openProductSpecificView: "openProductViewWithPid",
            addCard: "batchAddCard",
            openCard: "batchViewCard",
            chooseWXPay: "getBrandWCPayRequest",
            openEnterpriseRedPacket: "getRecevieBizHongBaoRequest",
            startSearchBeacons: "startMonitoringBeacons",
            stopSearchBeacons: "stopMonitoringBeacons",
            onSearchBeacons: "onBeaconsInRange",
            consumeAndShareCard: "consumedShareCard",
            openAddress: "editAddress"
        }, q = function () {
            var a = {};
            for (var b in p)a[p[b]] = b;
            return a
        }(), r = a.document, s = r.title, t = navigator.userAgent.toLowerCase(), u = navigator.platform.toLowerCase(), v = !(!u.match("mac") && !u.match("win")), w = -1 != t.indexOf("wxdebugger"), x = -1 != t.indexOf("micromessenger"), y = -1 != t.indexOf("android"), z = -1 != t.indexOf("iphone") || -1 != t.indexOf("ipad"), A = function () {
            var a = t.match(/micromessenger\/(\d+\.\d+\.\d+)/) || t.match(/micromessenger\/(\d+\.\d+)/);
            return a ? a[1] : ""
        }(), B = {initStartTime: m(), initEndTime: 0, preVerifyStartTime: 0, preVerifyEndTime: 0}, C = {
            version: 1,
            appId: "",
            initTime: 0,
            preVerifyTime: 0,
            networkType: "",
            isPreVerifyOk: 1,
            systemType: z ? 1 : y ? 2 : -1,
            clientVersion: A,
            url: encodeURIComponent(location.href)
        }, D = {}, E = {_completes: []}, F = {state: 0, data: {}};
        n(function () {
            B.initEndTime = m()
        });
        var G = !1, H = [], I = {
            config: function (a) {
                D = a, k("config", a);
                var b = D.check === !1 ? !1 : !0;
                n(function () {
                    if (b)c(p.config, {verifyJsApiList: j(D.jsApiList)}, function () {
                        E._complete = function (a) {
                            B.preVerifyEndTime = m(), F.state = 1, F.data = a
                        }, E.success = function (a) {
                            C.isPreVerifyOk = 0
                        }, E.fail = function (a) {
                            E._fail ? E._fail(a) : F.state = -1
                        };
                        var a = E._completes;
                        return a.push(function () {
                            l()
                        }), E.complete = function (b) {
                            for (var c = 0, d = a.length; d > c; ++c)a[c]();
                            E._completes = []
                        }, E
                    }()), B.preVerifyStartTime = m(); else {
                        F.state = 1;
                        for (var a = E._completes, d = 0, e = a.length; e > d; ++d)a[d]();
                        E._completes = []
                    }
                }), D.beta && o()
            }, ready: function (a) {
                0 != F.state ? a() : (E._completes.push(a), !x && D.debug && a())
            }, error: function (a) {
                "6.0.2" > A || (-1 == F.state ? a(F.data) : E._fail = a)
            }, checkJsApi: function (a) {
                var b = function (a) {
                    var b = a.checkResult;
                    for (var c in b) {
                        var d = q[c];
                        d && (b[d] = b[c], delete b[c])
                    }
                    return a
                };
                c("checkJsApi", {jsApiList: j(a.jsApiList)}, function () {
                    return a._complete = function (a) {
                        if (y) {
                            var c = a.checkResult;
                            c && (a.checkResult = JSON.parse(c))
                        }
                        a = b(a)
                    }, a
                }())
            }, onMenuShareTimeline: function (a) {
                d(p.onMenuShareTimeline, {
                    complete: function () {
                        c("shareTimeline", {
                            title: a.title || s,
                            desc: a.title || s,
                            img_url: a.imgUrl || "",
                            link: a.link || location.href,
                            type: a.type || "link",
                            data_url: a.dataUrl || ""
                        }, a)
                    }
                }, a)
            }, onMenuShareAppMessage: function (a) {
                d(p.onMenuShareAppMessage, {
                    complete: function () {
                        c("sendAppMessage", {
                            title: a.title || s,
                            desc: a.desc || "",
                            link: a.link || location.href,
                            img_url: a.imgUrl || "",
                            type: a.type || "link",
                            data_url: a.dataUrl || ""
                        }, a)
                    }
                }, a)
            }, onMenuShareQQ: function (a) {
                d(p.onMenuShareQQ, {
                    complete: function () {
                        c("shareQQ", {
                            title: a.title || s,
                            desc: a.desc || "",
                            img_url: a.imgUrl || "",
                            link: a.link || location.href
                        }, a)
                    }
                }, a)
            }, onMenuShareWeibo: function (a) {
                d(p.onMenuShareWeibo, {
                    complete: function () {
                        c("shareWeiboApp", {
                            title: a.title || s,
                            desc: a.desc || "",
                            img_url: a.imgUrl || "",
                            link: a.link || location.href
                        }, a)
                    }
                }, a)
            }, onMenuShareQZone: function (a) {
                d(p.onMenuShareQZone, {
                    complete: function () {
                        c("shareQZone", {
                            title: a.title || s,
                            desc: a.desc || "",
                            img_url: a.imgUrl || "",
                            link: a.link || location.href
                        }, a)
                    }
                }, a)
            }, startRecord: function (a) {
                c("startRecord", {}, a)
            }, stopRecord: function (a) {
                c("stopRecord", {}, a)
            }, onVoiceRecordEnd: function (a) {
                d("onVoiceRecordEnd", a)
            }, playVoice: function (a) {
                c("playVoice", {localId: a.localId}, a)
            }, pauseVoice: function (a) {
                c("pauseVoice", {localId: a.localId}, a)
            }, stopVoice: function (a) {
                c("stopVoice", {localId: a.localId}, a)
            }, onVoicePlayEnd: function (a) {
                d("onVoicePlayEnd", a)
            }, uploadVoice: function (a) {
                c("uploadVoice", {localId: a.localId, isShowProgressTips: 0 == a.isShowProgressTips ? 0 : 1}, a)
            }, downloadVoice: function (a) {
                c("downloadVoice", {serverId: a.serverId, isShowProgressTips: 0 == a.isShowProgressTips ? 0 : 1}, a)
            }, translateVoice: function (a) {
                c("translateVoice", {localId: a.localId, isShowProgressTips: 0 == a.isShowProgressTips ? 0 : 1}, a)
            }, chooseImage: function (a) {
                c("chooseImage", {
                    scene: "1|2",
                    count: a.count || 9,
                    sizeType: a.sizeType || ["original", "compressed"],
                    sourceType: a.sourceType || ["album", "camera"]
                }, function () {
                    return a._complete = function (a) {
                        if (y) {
                            var b = a.localIds;
                            b && (a.localIds = JSON.parse(b))
                        }
                    }, a
                }())
            }, getLocation: function (a) {
            }, previewImage: function (a) {
                c(p.previewImage, {current: a.current, urls: a.urls}, a)
            }, uploadImage: function (a) {
                c("uploadImage", {localId: a.localId, isShowProgressTips: 0 == a.isShowProgressTips ? 0 : 1}, a)
            }, downloadImage: function (a) {
                c("downloadImage", {serverId: a.serverId, isShowProgressTips: 0 == a.isShowProgressTips ? 0 : 1}, a)
            }, getLocalImgData: function (a) {
                G === !1 ? (G = !0, c("getLocalImgData", {localId: a.localId}, function () {
                    return a._complete = function (a) {
                        if (G = !1, H.length > 0) {
                            var b = H.shift();
                            wx.getLocalImgData(b)
                        }
                    }, a
                }())) : H.push(a)
            }, getNetworkType: function (a) {
                var b = function (a) {
                    var b = a.errMsg;
                    a.errMsg = "getNetworkType:ok";
                    var c = a.subtype;
                    if (delete a.subtype, c)a.networkType = c; else {
                        var d = b.indexOf(":"), e = b.substring(d + 1);
                        switch (e) {
                            case"wifi":
                            case"edge":
                            case"wwan":
                                a.networkType = e;
                                break;
                            default:
                                a.errMsg = "getNetworkType:fail"
                        }
                    }
                    return a
                };
                c("getNetworkType", {}, function () {
                    return a._complete = function (a) {
                        a = b(a)
                    }, a
                }())
            }, openLocation: function (a) {
                c("openLocation", {
                    latitude: a.latitude,
                    longitude: a.longitude,
                    name: a.name || "",
                    address: a.address || "",
                    scale: a.scale || 28,
                    infoUrl: a.infoUrl || ""
                }, a)
            }, getLocation: function (a) {
                a = a || {}, c(p.getLocation, {type: a.type || "wgs84"}, function () {
                    return a._complete = function (a) {
                        delete a.type
                    }, a
                }())
            }, hideOptionMenu: function (a) {
                c("hideOptionMenu", {}, a)
            }, showOptionMenu: function (a) {
                c("showOptionMenu", {}, a)
            }, closeWindow: function (a) {
                a = a || {}, c("closeWindow", {}, a)
            }, hideMenuItems: function (a) {
                c("hideMenuItems", {menuList: a.menuList}, a)
            }, showMenuItems: function (a) {
                c("showMenuItems", {menuList: a.menuList}, a)
            }, hideAllNonBaseMenuItem: function (a) {
                c("hideAllNonBaseMenuItem", {}, a)
            }, showAllNonBaseMenuItem: function (a) {
                c("showAllNonBaseMenuItem", {}, a)
            }, scanQRCode: function (a) {
                a = a || {}, c("scanQRCode", {
                    needResult: a.needResult || 0,
                    scanType: a.scanType || ["qrCode", "barCode"]
                }, function () {
                    return a._complete = function (a) {
                        if (z) {
                            var b = a.resultStr;
                            if (b) {
                                var c = JSON.parse(b);
                                a.resultStr = c && c.scan_code && c.scan_code.scan_result
                            }
                        }
                    }, a
                }())
            }, openAddress: function (a) {
                c(p.openAddress, {}, function () {
                    return a._complete = function (a) {
                        a = g(a)
                    }, a
                }())
            }, openProductSpecificView: function (a) {
                c(p.openProductSpecificView, {pid: a.productId, view_type: a.viewType || 0, ext_info: a.extInfo}, a)
            }, addCard: function (a) {
                for (var b = a.cardList, d = [], e = 0, f = b.length; f > e; ++e) {
                    var g = b[e], h = {card_id: g.cardId, card_ext: g.cardExt};
                    d.push(h)
                }
                c(p.addCard, {card_list: d}, function () {
                    return a._complete = function (a) {
                        var b = a.card_list;
                        if (b) {
                            b = JSON.parse(b);
                            for (var c = 0, d = b.length; d > c; ++c) {
                                var e = b[c];
                                e.cardId = e.card_id, e.cardExt = e.card_ext, e.isSuccess = e.is_succ ? !0 : !1, delete e.card_id, delete e.card_ext, delete e.is_succ
                            }
                            a.cardList = b, delete a.card_list
                        }
                    }, a
                }())
            }, chooseCard: function (a) {
                c("chooseCard", {
                    app_id: D.appId,
                    location_id: a.shopId || "",
                    sign_type: a.signType || "SHA1",
                    card_id: a.cardId || "",
                    card_type: a.cardType || "",
                    card_sign: a.cardSign,
                    time_stamp: a.timestamp + "",
                    nonce_str: a.nonceStr
                }, function () {
                    return a._complete = function (a) {
                        a.cardList = a.choose_card_info, delete a.choose_card_info
                    }, a
                }())
            }, openCard: function (a) {
                for (var b = a.cardList, d = [], e = 0, f = b.length; f > e; ++e) {
                    var g = b[e], h = {card_id: g.cardId, code: g.code};
                    d.push(h)
                }
                c(p.openCard, {card_list: d}, a)
            }, consumeAndShareCard: function (a) {
                c(p.consumeAndShareCard, {consumedCardId: a.cardId, consumedCode: a.code}, a)
            }, chooseWXPay: function (a) {
                c(p.chooseWXPay, f(a), a)
            }, openEnterpriseRedPacket: function (a) {
                c(p.openEnterpriseRedPacket, f(a), a)
            }, startSearchBeacons: function (a) {
                c(p.startSearchBeacons, {ticket: a.ticket}, a)
            }, stopSearchBeacons: function (a) {
                c(p.stopSearchBeacons, {}, a)
            }, onSearchBeacons: function (a) {
                d(p.onSearchBeacons, a)
            }, openEnterpriseChat: function (a) {
                c("openEnterpriseChat", {useridlist: a.userIds, chatname: a.groupName}, a)
            }
        }, J = 1, K = {};
        return r.addEventListener("error", function (a) {
            if (!y) {
                var b = a.target, c = b.tagName, d = b.src;
                if ("IMG" == c || "VIDEO" == c || "AUDIO" == c || "SOURCE" == c) {
                    var e = -1 != d.indexOf("wxlocalresource://");
                    if (e) {
                        a.preventDefault(), a.stopPropagation();
                        var f = b["wx-id"];
                        if (f || (f = J++, b["wx-id"] = f), K[f])return;
                        K[f] = !0, wx.getLocalImgData({
                            localId: d, success: function (a) {
                                b.src = a.localData
                            }
                        })
                    }
                }
            }
        }, !0), r.addEventListener("load", function (a) {
            if (!y) {
                var b = a.target, c = b.tagName;
                b.src;
                if ("IMG" == c || "VIDEO" == c || "AUDIO" == c || "SOURCE" == c) {
                    var d = b["wx-id"];
                    d && (K[d] = !1)
                }
            }
        }, !0), b && (a.wx = a.jWeixin = I), I
    }
});

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _promisify = __webpack_require__(2);

var _promisify2 = _interopRequireDefault(_promisify);

var _register = __webpack_require__(5);

var _register2 = _interopRequireDefault(_register);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_promisify2.default.register = _register2.default;
module.exports = _promisify2.default;

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _weixinJsSdk = __webpack_require__(0);

var _weixinJsSdk2 = _interopRequireDefault(_weixinJsSdk);

var _apiList = __webpack_require__(3);

var _hook = __webpack_require__(4);

var hook = _interopRequireWildcard(_hook);

var _utils = __webpack_require__(6);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }

var promisify = function promisify(obj, method, sync) {
  var origin = obj[method].bind(obj);
  obj[method] = function () {
    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

    var _success = _ref.success,
        _fail = _ref.fail,
        otherArgs = _objectWithoutProperties(_ref, ['success', 'fail']);

    return new Promise(function (resolve, reject) {
      if (!_utils.inWX) return (0, _utils.log)('not in weixin') && resolve({ errMsg: 'not in weixin' });

      _weixinJsSdk2.default.ready(function () {
        if (hook[method]) otherArgs = hook[method](_extends({}, otherArgs));
        if (sync) return resolve(origin(_extends({}, otherArgs)));

        origin(_extends({}, otherArgs, {
          success: function success() {
            if (_success) _success.apply(undefined, arguments);
            resolve.apply(undefined, arguments);
          },
          fail: function fail() {
            if (_fail) _fail.apply(undefined, arguments);
            reject.apply(undefined, arguments);
          }
        }));
      });
    });
  };
};

_apiList.asyncList.forEach(function (key) {
  return promisify(_weixinJsSdk2.default, key);
});
_apiList.syncList.forEach(function (key) {
  return promisify(_weixinJsSdk2.default, key, true);
});

exports.default = _weixinJsSdk2.default;

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
var asyncList = exports.asyncList = ['checkJsApi', 'openEnterpriseChat', 'onMenuShareAppMessage', 'chooseImage', 'uploadImage', 'downloadImage', 'stopRecord', 'onVoicePlayEnd', 'uploadVoice', 'downloadVoice', 'getNetworkType', 'getLocation', 'scanQRCode'];

var syncList = exports.syncList = ['onVoiceRecordEnd', 'startRecord', 'playVoice', 'pauseVoice', 'stopVoice', 'previewImage', 'openLocation', 'hideOptionMenu', 'showOptionMenu', 'hideMenuItems', 'showMenuItems', 'hideAllNonBaseMenuItem', 'showAllNonBaseMenuItem', 'closeWindow'];

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
var previewImage = exports.previewImage = function previewImage(_ref) {
  var current = _ref.current,
      urls = _ref.urls;

  var toHttp = function toHttp(url) {
    return url.replace(/^https*/, 'http');
  };
  return { current: toHttp(current), urls: urls.map(toHttp) };
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _weixinJsSdk = __webpack_require__(0);

var _weixinJsSdk2 = _interopRequireDefault(_weixinJsSdk);

var _utils = __webpack_require__(6);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (_ref) {
  var appid = _ref.appid,
      signatureUrl = _ref.signatureUrl,
      _ref$debug = _ref.debug,
      debug = _ref$debug === undefined ? false : _ref$debug,
      jsApiList = _ref.jsApiList;

  if (!(appid || signatureUrl)) return (0, _utils.log)('invalid params! appid, signatureUrl should have value');


  (0, _utils.getRequest)(signatureUrl).then(function (_ref2) {
    var data = _ref2.data,
        code = _ref2.code;

    if (code != 0) return (0, _utils.log)('get signature error!');
    var timestamp = data.timestamp,
        nonceStr = data.nonceStr,
        signature = data.signature;

    _weixinJsSdk2.default.config({
      beta: true,
      debug: debug,
      appId: appid,
      timestamp: timestamp,
      nonceStr: nonceStr,
      signature: signature,
      jsApiList: jsApiList });
  });
};

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
var inWX = exports.inWX = navigator.userAgent.toLowerCase().match('micromessenger');

var log = exports.log = function log(msg) {
  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'error';
  return console[type]('wx-sdk-promise: ', msg);
};

var getRequest = exports.getRequest = function getRequest(url, params) {
  return new Promise(function (resolve, reject) {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.onreadystatechange = function () {
      if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
        resolve(JSON.parse(xmlHttp.responseText));
      }
    };

    xmlHttp.open("GET", url, true);
    xmlHttp.send(null);
  });
};

/***/ })
/******/ ]);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAzN2YwMzYxMWY3YWEzYmNjZjNjNiIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvX3dlaXhpbi1qcy1zZGtAMS4yLjBAd2VpeGluLWpzLXNkay9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Byb21pc2lmeS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBpTGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaG9vay5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvcmVnaXN0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIl0sIm5hbWVzIjpbInJlZ2lzdGVyIiwibW9kdWxlIiwiZXhwb3J0cyIsImhvb2siLCJwcm9taXNpZnkiLCJvYmoiLCJtZXRob2QiLCJzeW5jIiwib3JpZ2luIiwiYmluZCIsInN1Y2Nlc3MiLCJmYWlsIiwib3RoZXJBcmdzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlcnJNc2ciLCJyZWFkeSIsImZvckVhY2giLCJrZXkiLCJhc3luY0xpc3QiLCJzeW5jTGlzdCIsInByZXZpZXdJbWFnZSIsImN1cnJlbnQiLCJ1cmxzIiwidG9IdHRwIiwidXJsIiwicmVwbGFjZSIsIm1hcCIsImFwcGlkIiwic2lnbmF0dXJlVXJsIiwiZGVidWciLCJqc0FwaUxpc3QiLCJ0aGVuIiwiZGF0YSIsImNvZGUiLCJ0aW1lc3RhbXAiLCJub25jZVN0ciIsInNpZ25hdHVyZSIsImNvbmZpZyIsImJldGEiLCJhcHBJZCIsImluV1giLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b0xvd2VyQ2FzZSIsIm1hdGNoIiwibG9nIiwibXNnIiwidHlwZSIsImNvbnNvbGUiLCJnZXRSZXF1ZXN0IiwicGFyYW1zIiwieG1sSHR0cCIsIlhNTEh0dHBSZXF1ZXN0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInN0YXR1cyIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsIm9wZW4iLCJzZW5kIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsTztBQ1ZBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFFckg7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7O0FDN0RBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLDBCQUEwQjtBQUMxQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHNGQUFzRjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUNBQXlDLE9BQU87QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTLFNBQVMsK0VBQStFO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsUUFBUSxPQUFPLGVBQWUsT0FBTztBQUM5QztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsZ0NBQWdDO0FBQ3ZFO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6Qix5REFBeUQsT0FBTztBQUNoRTtBQUNBLHlCQUF5QjtBQUN6QixxQkFBcUIsZ0NBQWdDO0FBQ3JEO0FBQ0EsdUVBQXVFLE9BQU87QUFDOUU7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQywwQkFBMEI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiLG1DQUFtQztBQUNuQyxhQUFhO0FBQ2Isa0NBQWtDO0FBQ2xDLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYixnQ0FBZ0MsbUJBQW1CO0FBQ25ELGFBQWE7QUFDYixpQ0FBaUMsbUJBQW1CO0FBQ3BELGFBQWE7QUFDYixnQ0FBZ0MsbUJBQW1CO0FBQ25ELGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYixrQ0FBa0MsMEVBQTBFO0FBQzVHLGFBQWE7QUFDYixvQ0FBb0MsNEVBQTRFO0FBQ2hILGFBQWE7QUFDYixxQ0FBcUMsMEVBQTBFO0FBQy9HLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYixhQUFhO0FBQ2IsbUNBQW1DLGlDQUFpQztBQUNwRSxhQUFhO0FBQ2Isa0NBQWtDLDBFQUEwRTtBQUM1RyxhQUFhO0FBQ2Isb0NBQW9DLDRFQUE0RTtBQUNoSCxhQUFhO0FBQ2IsMERBQTBELG1CQUFtQjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYiwyQkFBMkIsb0JBQW9CLHdCQUF3QjtBQUN2RTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2Isc0NBQXNDO0FBQ3RDLGFBQWE7QUFDYixzQ0FBc0M7QUFDdEMsYUFBYTtBQUNiLDJCQUEyQixxQkFBcUI7QUFDaEQsYUFBYTtBQUNiLG9DQUFvQyxxQkFBcUI7QUFDekQsYUFBYTtBQUNiLG9DQUFvQyxxQkFBcUI7QUFDekQsYUFBYTtBQUNiLDhDQUE4QztBQUM5QyxhQUFhO0FBQ2IsOENBQThDO0FBQzlDLGFBQWE7QUFDYiwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IsbUNBQW1DO0FBQ25DO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYiw4Q0FBOEMsa0VBQWtFO0FBQ2hILGFBQWE7QUFDYixxRUFBcUUsT0FBTztBQUM1RSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBLDhCQUE4QixhQUFhO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlELE9BQU87QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2IscUVBQXFFLE9BQU87QUFDNUUsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQSwrQkFBK0IsYUFBYTtBQUM1QyxhQUFhO0FBQ2IsMENBQTBDLCtDQUErQztBQUN6RixhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2IseUNBQXlDLGlCQUFpQjtBQUMxRCxhQUFhO0FBQ2IseUNBQXlDO0FBQ3pDLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYix5Q0FBeUMsNkNBQTZDO0FBQ3RGO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsQ0FBQyxFOzs7Ozs7Ozs7QUNsZEQ7Ozs7QUFDQTs7Ozs7O0FBRUEsb0JBQUdBLFFBQUg7QUFDQUMsT0FBT0MsT0FBUCx1Qjs7Ozs7Ozs7Ozs7Ozs7O0FDSkE7Ozs7QUFDQTs7QUFDQTs7SUFBWUMsSTs7QUFDWjs7Ozs7Ozs7QUFFQSxJQUFNQyxZQUFZLFNBQVpBLFNBQVksQ0FBQ0MsR0FBRCxFQUFNQyxNQUFOLEVBQWNDLElBQWQsRUFBdUI7QUFDdkMsTUFBTUMsU0FBU0gsSUFBSUMsTUFBSixFQUFZRyxJQUFaLENBQWlCSixHQUFqQixDQUFmO0FBQ0FBLE1BQUlDLE1BQUosSUFBYyxZQUE2QztBQUFBLG1GQUFKLEVBQUk7O0FBQUEsUUFBbkNJLFFBQW1DLFFBQW5DQSxPQUFtQztBQUFBLFFBQTFCQyxLQUEwQixRQUExQkEsSUFBMEI7QUFBQSxRQUFqQkMsU0FBaUI7O0FBQ3pELFdBQU8sSUFBSUMsT0FBSixDQUFZLFVBQUNDLE9BQUQsRUFBVUMsTUFBVixFQUFxQjtBQUN0QyxVQUFHLFlBQUgsRUFBVSxPQUFPLGdCQUFJLGVBQUosS0FBd0JELFFBQVEsRUFBQ0UsUUFBUSxlQUFULEVBQVIsQ0FBL0I7O0FBRVYsNEJBQUdDLEtBQUgsQ0FBUyxZQUFNO0FBQ2IsWUFBR2QsS0FBS0csTUFBTCxDQUFILEVBQWlCTSxZQUFZVCxLQUFLRyxNQUFMLGVBQWlCTSxTQUFqQixFQUFaO0FBQ2pCLFlBQUdMLElBQUgsRUFBUyxPQUFPTyxRQUFRTixvQkFBV0ksU0FBWCxFQUFSLENBQVA7O0FBRVRKLDRCQUNLSSxTQURMO0FBRUVGLG1CQUFTLG1CQUFhO0FBQ3BCLGdCQUFHQSxRQUFILEVBQVlBO0FBQ1pJO0FBQ0QsV0FMSDtBQU1FSCxnQkFBTSxnQkFBYTtBQUNqQixnQkFBR0EsS0FBSCxFQUFTQTtBQUNUSTtBQUNEO0FBVEg7QUFXRCxPQWZEO0FBZ0JELEtBbkJNLENBQVA7QUFvQkQsR0FyQkQ7QUFzQkQsQ0F4QkQ7O0FBMEJBLG1CQUFVRyxPQUFWLENBQWtCO0FBQUEsU0FBT2QsaUNBQWNlLEdBQWQsQ0FBUDtBQUFBLENBQWxCO0FBQ0Esa0JBQVNELE9BQVQsQ0FBaUI7QUFBQSxTQUFPZCxpQ0FBY2UsR0FBZCxFQUFtQixJQUFuQixDQUFQO0FBQUEsQ0FBakI7Ozs7Ozs7Ozs7Ozs7O0FDaENPLElBQU1DLGdDQUFZLENBQ3ZCLFlBRHVCLEVBRXZCLG9CQUZ1QixFQUd2Qix1QkFIdUIsRUFNdkIsYUFOdUIsRUFPdkIsYUFQdUIsRUFRdkIsZUFSdUIsRUFTdkIsWUFUdUIsRUFVdkIsZ0JBVnVCLEVBV3ZCLGFBWHVCLEVBWXZCLGVBWnVCLEVBYXZCLGdCQWJ1QixFQWN2QixhQWR1QixFQWV2QixZQWZ1QixDQUFsQjs7QUFvQkEsSUFBTUMsOEJBQVcsQ0FDdEIsa0JBRHNCLEVBR3RCLGFBSHNCLEVBSXRCLFdBSnNCLEVBS3RCLFlBTHNCLEVBTXRCLFdBTnNCLEVBT3RCLGNBUHNCLEVBU3RCLGNBVHNCLEVBV3RCLGdCQVhzQixFQVl0QixnQkFac0IsRUFhdEIsZUFic0IsRUFjdEIsZUFkc0IsRUFldEIsd0JBZnNCLEVBZ0J0Qix3QkFoQnNCLEVBaUJ0QixhQWpCc0IsQ0FBakIsQzs7Ozs7Ozs7Ozs7O0FDbkJBLElBQU1DLHNDQUFlLFNBQWZBLFlBQWUsT0FBcUI7QUFBQSxNQUFuQkMsT0FBbUIsUUFBbkJBLE9BQW1CO0FBQUEsTUFBVkMsSUFBVSxRQUFWQSxJQUFVOztBQUMvQyxNQUFNQyxTQUFTLFNBQVRBLE1BQVMsQ0FBQ0MsR0FBRDtBQUFBLFdBQVNBLElBQUlDLE9BQUosQ0FBWSxTQUFaLEVBQXVCLE1BQXZCLENBQVQ7QUFBQSxHQUFmO0FBQ0EsU0FBTyxFQUFDSixTQUFTRSxPQUFPRixPQUFQLENBQVYsRUFBMkJDLE1BQU1BLEtBQUtJLEdBQUwsQ0FBU0gsTUFBVCxDQUFqQyxFQUFQO0FBQ0QsQ0FITSxDOzs7Ozs7Ozs7Ozs7O0FDRFA7Ozs7QUFDQTs7OztrQkFHZSxnQkFBcUQ7QUFBQSxNQUFuREksS0FBbUQsUUFBbkRBLEtBQW1EO0FBQUEsTUFBNUNDLFlBQTRDLFFBQTVDQSxZQUE0QztBQUFBLHdCQUE5QkMsS0FBOEI7QUFBQSxNQUE5QkEsS0FBOEIsOEJBQXRCLEtBQXNCO0FBQUEsTUFBZkMsU0FBZSxRQUFmQSxTQUFlOztBQUNsRSxNQUFHLEVBQUVILFNBQVNDLFlBQVgsQ0FBSCxFQUE2QixPQUFPLGdCQUFJLHVEQUFKLENBQVA7OztBQUc3Qix5QkFBV0EsWUFBWCxFQUF5QkcsSUFBekIsQ0FBOEIsaUJBQWtCO0FBQUEsUUFBaEJDLElBQWdCLFNBQWhCQSxJQUFnQjtBQUFBLFFBQVZDLElBQVUsU0FBVkEsSUFBVTs7QUFDOUMsUUFBR0EsUUFBUSxDQUFYLEVBQWMsT0FBTyxnQkFBSSxzQkFBSixDQUFQO0FBRGdDLFFBRXZDQyxTQUZ1QyxHQUVMRixJQUZLLENBRXZDRSxTQUZ1QztBQUFBLFFBRTVCQyxRQUY0QixHQUVMSCxJQUZLLENBRTVCRyxRQUY0QjtBQUFBLFFBRWxCQyxTQUZrQixHQUVMSixJQUZLLENBRWxCSSxTQUZrQjs7QUFHOUMsMEJBQUdDLE1BQUgsQ0FBVTtBQUNSQyxZQUFNLElBREU7QUFFUlQsa0JBRlE7QUFJUlUsYUFBT1osS0FKQztBQUtSTywwQkFMUTtBQU1SQyx3QkFOUTtBQU9SQywwQkFQUTtBQVFSTiwwQkFSUSxFQUFWO0FBVUQsR0FiRDtBQWNELEM7Ozs7Ozs7Ozs7OztBQ3JCTSxJQUFNVSxzQkFBT0MsVUFBVUMsU0FBVixDQUFvQkMsV0FBcEIsR0FBa0NDLEtBQWxDLENBQXdDLGdCQUF4QyxDQUFiOztBQUVBLElBQU1DLG9CQUFNLFNBQU5BLEdBQU0sQ0FBQ0MsR0FBRDtBQUFBLE1BQU1DLElBQU4sdUVBQVcsT0FBWDtBQUFBLFNBQXVCQyxRQUFRRCxJQUFSLEVBQWMsa0JBQWQsRUFBa0NELEdBQWxDLENBQXZCO0FBQUEsQ0FBWjs7QUFFQSxJQUFNRyxrQ0FBYSxTQUFiQSxVQUFhLENBQUN6QixHQUFELEVBQU0wQixNQUFOLEVBQWlCO0FBQ3pDLFNBQU8sSUFBSXZDLE9BQUosQ0FBWSxVQUFDQyxPQUFELEVBQVVDLE1BQVYsRUFBcUI7QUFDdEMsUUFBSXNDLFVBQVUsSUFBSUMsY0FBSixFQUFkO0FBQ0FELFlBQVFFLGtCQUFSLEdBQTZCLFlBQVc7QUFDcEMsVUFBSUYsUUFBUUcsVUFBUixJQUFzQixDQUF0QixJQUEyQkgsUUFBUUksTUFBUixJQUFrQixHQUFqRCxFQUFzRDtBQUNwRDNDLGdCQUFRNEMsS0FBS0MsS0FBTCxDQUFXTixRQUFRTyxZQUFuQixDQUFSO0FBQ0Q7QUFDSixLQUpEOztBQU1BUCxZQUFRUSxJQUFSLENBQWEsS0FBYixFQUFvQm5DLEdBQXBCLEVBQXlCLElBQXpCO0FBQ0EyQixZQUFRUyxJQUFSLENBQWEsSUFBYjtBQUNELEdBVk0sQ0FBUDtBQVdELENBWk0sQyIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJ3eFwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJ3eFwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMzdmMDM2MTFmN2FhM2JjY2YzYzYiLCIhZnVuY3Rpb24gKGEsIGIpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGIoYSlcbn0od2luZG93LCBmdW5jdGlvbiAoYSwgYikge1xuICAgIGZ1bmN0aW9uIGMoYiwgYywgZCkge1xuICAgICAgICBhLldlaXhpbkpTQnJpZGdlID8gV2VpeGluSlNCcmlkZ2UuaW52b2tlKGIsIGUoYyksIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICBoKGIsIGEsIGQpXG4gICAgICAgIH0pIDogayhiLCBkKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGQoYiwgYywgZCkge1xuICAgICAgICBhLldlaXhpbkpTQnJpZGdlID8gV2VpeGluSlNCcmlkZ2Uub24oYiwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGQgJiYgZC50cmlnZ2VyICYmIGQudHJpZ2dlcihhKSwgaChiLCBhLCBjKVxuICAgICAgICB9KSA6IGQgPyBrKGIsIGQpIDogayhiLCBjKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGUoYSkge1xuICAgICAgICByZXR1cm4gYSA9IGEgfHwge30sIGEuYXBwSWQgPSBELmFwcElkLCBhLnZlcmlmeUFwcElkID0gRC5hcHBJZCwgYS52ZXJpZnlTaWduVHlwZSA9IFwic2hhMVwiLCBhLnZlcmlmeVRpbWVzdGFtcCA9IEQudGltZXN0YW1wICsgXCJcIiwgYS52ZXJpZnlOb25jZVN0ciA9IEQubm9uY2VTdHIsIGEudmVyaWZ5U2lnbmF0dXJlID0gRC5zaWduYXR1cmUsIGFcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmKGEpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRpbWVTdGFtcDogYS50aW1lc3RhbXAgKyBcIlwiLFxuICAgICAgICAgICAgbm9uY2VTdHI6IGEubm9uY2VTdHIsXG4gICAgICAgICAgICBcInBhY2thZ2VcIjogYVtcInBhY2thZ2VcIl0sXG4gICAgICAgICAgICBwYXlTaWduOiBhLnBheVNpZ24sXG4gICAgICAgICAgICBzaWduVHlwZTogYS5zaWduVHlwZSB8fCBcIlNIQTFcIlxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZyhhKSB7XG4gICAgICAgIHJldHVybiBhLnBvc3RhbENvZGUgPSBhLmFkZHJlc3NQb3N0YWxDb2RlLCBkZWxldGUgYS5hZGRyZXNzUG9zdGFsQ29kZSwgYS5wcm92aW5jZU5hbWUgPSBhLnByb3ZpY2VGaXJzdFN0YWdlTmFtZSwgZGVsZXRlIGEucHJvdmljZUZpcnN0U3RhZ2VOYW1lLCBhLmNpdHlOYW1lID0gYS5hZGRyZXNzQ2l0eVNlY29uZFN0YWdlTmFtZSwgZGVsZXRlIGEuYWRkcmVzc0NpdHlTZWNvbmRTdGFnZU5hbWUsIGEuY291bnRyeU5hbWUgPSBhLmFkZHJlc3NDb3VudGllc1RoaXJkU3RhZ2VOYW1lLCBkZWxldGUgYS5hZGRyZXNzQ291bnRpZXNUaGlyZFN0YWdlTmFtZSwgYS5kZXRhaWxJbmZvID0gYS5hZGRyZXNzRGV0YWlsSW5mbywgZGVsZXRlIGEuYWRkcmVzc0RldGFpbEluZm8sIGFcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoKGEsIGIsIGMpIHtcbiAgICAgICAgXCJvcGVuRW50ZXJwcmlzZUNoYXRcIiA9PSBhICYmIChiLmVyckNvZGUgPSBiLmVycl9jb2RlKSwgZGVsZXRlIGIuZXJyX2NvZGUsIGRlbGV0ZSBiLmVycl9kZXNjLCBkZWxldGUgYi5lcnJfZGV0YWlsO1xuICAgICAgICB2YXIgZCA9IGIuZXJyTXNnO1xuICAgICAgICBkIHx8IChkID0gYi5lcnJfbXNnLCBkZWxldGUgYi5lcnJfbXNnLCBkID0gaShhLCBkKSwgYi5lcnJNc2cgPSBkKSwgYyA9IGMgfHwge30sIGMuX2NvbXBsZXRlICYmIChjLl9jb21wbGV0ZShiKSwgZGVsZXRlIGMuX2NvbXBsZXRlKSwgZCA9IGIuZXJyTXNnIHx8IFwiXCIsIEQuZGVidWcgJiYgIWMuaXNJbm5lckludm9rZSAmJiBhbGVydChKU09OLnN0cmluZ2lmeShiKSk7XG4gICAgICAgIHZhciBlID0gZC5pbmRleE9mKFwiOlwiKSwgZiA9IGQuc3Vic3RyaW5nKGUgKyAxKTtcbiAgICAgICAgc3dpdGNoIChmKSB7XG4gICAgICAgICAgICBjYXNlXCJva1wiOlxuICAgICAgICAgICAgICAgIGMuc3VjY2VzcyAmJiBjLnN1Y2Nlc3MoYik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlXCJjYW5jZWxcIjpcbiAgICAgICAgICAgICAgICBjLmNhbmNlbCAmJiBjLmNhbmNlbChiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYy5mYWlsICYmIGMuZmFpbChiKVxuICAgICAgICB9XG4gICAgICAgIGMuY29tcGxldGUgJiYgYy5jb21wbGV0ZShiKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGkoYSwgYikge1xuICAgICAgICB2YXIgYyA9IGEsIGQgPSBxW2NdO1xuICAgICAgICBkICYmIChjID0gZCk7XG4gICAgICAgIHZhciBlID0gXCJva1wiO1xuICAgICAgICBpZiAoYikge1xuICAgICAgICAgICAgdmFyIGYgPSBiLmluZGV4T2YoXCI6XCIpO1xuICAgICAgICAgICAgZSA9IGIuc3Vic3RyaW5nKGYgKyAxKSwgXCJjb25maXJtXCIgPT0gZSAmJiAoZSA9IFwib2tcIiksIFwiZmFpbGVkXCIgPT0gZSAmJiAoZSA9IFwiZmFpbFwiKSwgLTEgIT0gZS5pbmRleE9mKFwiZmFpbGVkX1wiKSAmJiAoZSA9IGUuc3Vic3RyaW5nKDcpKSwgLTEgIT0gZS5pbmRleE9mKFwiZmFpbF9cIikgJiYgKGUgPSBlLnN1YnN0cmluZyg1KSksIGUgPSBlLnJlcGxhY2UoL18vZywgXCIgXCIpLCBlID0gZS50b0xvd2VyQ2FzZSgpLCAoXCJhY2Nlc3MgZGVuaWVkXCIgPT0gZSB8fCBcIm5vIHBlcm1pc3Npb24gdG8gZXhlY3V0ZVwiID09IGUpICYmIChlID0gXCJwZXJtaXNzaW9uIGRlbmllZFwiKSwgXCJjb25maWdcIiA9PSBjICYmIFwiZnVuY3Rpb24gbm90IGV4aXN0XCIgPT0gZSAmJiAoZSA9IFwib2tcIiksIFwiXCIgPT0gZSAmJiAoZSA9IFwiZmFpbFwiKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiID0gYyArIFwiOlwiICsgZVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGooYSkge1xuICAgICAgICBpZiAoYSkge1xuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDAsIGMgPSBhLmxlbmd0aDsgYyA+IGI7ICsrYikge1xuICAgICAgICAgICAgICAgIHZhciBkID0gYVtiXSwgZSA9IHBbZF07XG4gICAgICAgICAgICAgICAgZSAmJiAoYVtiXSA9IGUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gayhhLCBiKSB7XG4gICAgICAgIGlmICghKCFELmRlYnVnIHx8IGIgJiYgYi5pc0lubmVySW52b2tlKSkge1xuICAgICAgICAgICAgdmFyIGMgPSBxW2FdO1xuICAgICAgICAgICAgYyAmJiAoYSA9IGMpLCBiICYmIGIuX2NvbXBsZXRlICYmIGRlbGV0ZSBiLl9jb21wbGV0ZSwgY29uc29sZS5sb2coJ1wiJyArIGEgKyAnXCIsJywgYiB8fCBcIlwiKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbChhKSB7XG4gICAgICAgIGlmICghKHYgfHwgdyB8fCBELmRlYnVnIHx8IFwiNi4wLjJcIiA+IEEgfHwgQy5zeXN0ZW1UeXBlIDwgMCkpIHtcbiAgICAgICAgICAgIHZhciBiID0gbmV3IEltYWdlO1xuICAgICAgICAgICAgQy5hcHBJZCA9IEQuYXBwSWQsIEMuaW5pdFRpbWUgPSBCLmluaXRFbmRUaW1lIC0gQi5pbml0U3RhcnRUaW1lLCBDLnByZVZlcmlmeVRpbWUgPSBCLnByZVZlcmlmeUVuZFRpbWUgLSBCLnByZVZlcmlmeVN0YXJ0VGltZSwgSS5nZXROZXR3b3JrVHlwZSh7XG4gICAgICAgICAgICAgICAgaXNJbm5lckludm9rZTogITAsXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgQy5uZXR3b3JrVHlwZSA9IGEubmV0d29ya1R5cGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gXCJodHRwczovL29wZW4ud2VpeGluLnFxLmNvbS9zZGsvcmVwb3J0P3Y9XCIgKyBDLnZlcnNpb24gKyBcIiZvPVwiICsgQy5pc1ByZVZlcmlmeU9rICsgXCImcz1cIiArIEMuc3lzdGVtVHlwZSArIFwiJmM9XCIgKyBDLmNsaWVudFZlcnNpb24gKyBcIiZhPVwiICsgQy5hcHBJZCArIFwiJm49XCIgKyBDLm5ldHdvcmtUeXBlICsgXCImaT1cIiArIEMuaW5pdFRpbWUgKyBcIiZwPVwiICsgQy5wcmVWZXJpZnlUaW1lICsgXCImdT1cIiArIEMudXJsO1xuICAgICAgICAgICAgICAgICAgICBiLnNyYyA9IGNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbSgpIHtcbiAgICAgICAgcmV0dXJuIChuZXcgRGF0ZSkuZ2V0VGltZSgpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbihiKSB7XG4gICAgICAgIHggJiYgKGEuV2VpeGluSlNCcmlkZ2UgPyBiKCkgOiByLmFkZEV2ZW50TGlzdGVuZXIgJiYgci5hZGRFdmVudExpc3RlbmVyKFwiV2VpeGluSlNCcmlkZ2VSZWFkeVwiLCBiLCAhMSkpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbygpIHtcbiAgICAgICAgSS5pbnZva2UgfHwgKEkuaW52b2tlID0gZnVuY3Rpb24gKGIsIGMsIGQpIHtcbiAgICAgICAgICAgIGEuV2VpeGluSlNCcmlkZ2UgJiYgV2VpeGluSlNCcmlkZ2UuaW52b2tlKGIsIGUoYyksIGQpXG4gICAgICAgIH0sIEkub24gPSBmdW5jdGlvbiAoYiwgYykge1xuICAgICAgICAgICAgYS5XZWl4aW5KU0JyaWRnZSAmJiBXZWl4aW5KU0JyaWRnZS5vbihiLCBjKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGlmICghYS5qV2VpeGluKSB7XG4gICAgICAgIHZhciBwID0ge1xuICAgICAgICAgICAgY29uZmlnOiBcInByZVZlcmlmeUpTQVBJXCIsXG4gICAgICAgICAgICBvbk1lbnVTaGFyZVRpbWVsaW5lOiBcIm1lbnU6c2hhcmU6dGltZWxpbmVcIixcbiAgICAgICAgICAgIG9uTWVudVNoYXJlQXBwTWVzc2FnZTogXCJtZW51OnNoYXJlOmFwcG1lc3NhZ2VcIixcbiAgICAgICAgICAgIG9uTWVudVNoYXJlUVE6IFwibWVudTpzaGFyZTpxcVwiLFxuICAgICAgICAgICAgb25NZW51U2hhcmVXZWlibzogXCJtZW51OnNoYXJlOndlaWJvQXBwXCIsXG4gICAgICAgICAgICBvbk1lbnVTaGFyZVFab25lOiBcIm1lbnU6c2hhcmU6UVpvbmVcIixcbiAgICAgICAgICAgIHByZXZpZXdJbWFnZTogXCJpbWFnZVByZXZpZXdcIixcbiAgICAgICAgICAgIGdldExvY2F0aW9uOiBcImdlb0xvY2F0aW9uXCIsXG4gICAgICAgICAgICBvcGVuUHJvZHVjdFNwZWNpZmljVmlldzogXCJvcGVuUHJvZHVjdFZpZXdXaXRoUGlkXCIsXG4gICAgICAgICAgICBhZGRDYXJkOiBcImJhdGNoQWRkQ2FyZFwiLFxuICAgICAgICAgICAgb3BlbkNhcmQ6IFwiYmF0Y2hWaWV3Q2FyZFwiLFxuICAgICAgICAgICAgY2hvb3NlV1hQYXk6IFwiZ2V0QnJhbmRXQ1BheVJlcXVlc3RcIixcbiAgICAgICAgICAgIG9wZW5FbnRlcnByaXNlUmVkUGFja2V0OiBcImdldFJlY2V2aWVCaXpIb25nQmFvUmVxdWVzdFwiLFxuICAgICAgICAgICAgc3RhcnRTZWFyY2hCZWFjb25zOiBcInN0YXJ0TW9uaXRvcmluZ0JlYWNvbnNcIixcbiAgICAgICAgICAgIHN0b3BTZWFyY2hCZWFjb25zOiBcInN0b3BNb25pdG9yaW5nQmVhY29uc1wiLFxuICAgICAgICAgICAgb25TZWFyY2hCZWFjb25zOiBcIm9uQmVhY29uc0luUmFuZ2VcIixcbiAgICAgICAgICAgIGNvbnN1bWVBbmRTaGFyZUNhcmQ6IFwiY29uc3VtZWRTaGFyZUNhcmRcIixcbiAgICAgICAgICAgIG9wZW5BZGRyZXNzOiBcImVkaXRBZGRyZXNzXCJcbiAgICAgICAgfSwgcSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhID0ge307XG4gICAgICAgICAgICBmb3IgKHZhciBiIGluIHApYVtwW2JdXSA9IGI7XG4gICAgICAgICAgICByZXR1cm4gYVxuICAgICAgICB9KCksIHIgPSBhLmRvY3VtZW50LCBzID0gci50aXRsZSwgdCA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSwgdSA9IG5hdmlnYXRvci5wbGF0Zm9ybS50b0xvd2VyQ2FzZSgpLCB2ID0gISghdS5tYXRjaChcIm1hY1wiKSAmJiAhdS5tYXRjaChcIndpblwiKSksIHcgPSAtMSAhPSB0LmluZGV4T2YoXCJ3eGRlYnVnZ2VyXCIpLCB4ID0gLTEgIT0gdC5pbmRleE9mKFwibWljcm9tZXNzZW5nZXJcIiksIHkgPSAtMSAhPSB0LmluZGV4T2YoXCJhbmRyb2lkXCIpLCB6ID0gLTEgIT0gdC5pbmRleE9mKFwiaXBob25lXCIpIHx8IC0xICE9IHQuaW5kZXhPZihcImlwYWRcIiksIEEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYSA9IHQubWF0Y2goL21pY3JvbWVzc2VuZ2VyXFwvKFxcZCtcXC5cXGQrXFwuXFxkKykvKSB8fCB0Lm1hdGNoKC9taWNyb21lc3NlbmdlclxcLyhcXGQrXFwuXFxkKykvKTtcbiAgICAgICAgICAgIHJldHVybiBhID8gYVsxXSA6IFwiXCJcbiAgICAgICAgfSgpLCBCID0ge2luaXRTdGFydFRpbWU6IG0oKSwgaW5pdEVuZFRpbWU6IDAsIHByZVZlcmlmeVN0YXJ0VGltZTogMCwgcHJlVmVyaWZ5RW5kVGltZTogMH0sIEMgPSB7XG4gICAgICAgICAgICB2ZXJzaW9uOiAxLFxuICAgICAgICAgICAgYXBwSWQ6IFwiXCIsXG4gICAgICAgICAgICBpbml0VGltZTogMCxcbiAgICAgICAgICAgIHByZVZlcmlmeVRpbWU6IDAsXG4gICAgICAgICAgICBuZXR3b3JrVHlwZTogXCJcIixcbiAgICAgICAgICAgIGlzUHJlVmVyaWZ5T2s6IDEsXG4gICAgICAgICAgICBzeXN0ZW1UeXBlOiB6ID8gMSA6IHkgPyAyIDogLTEsXG4gICAgICAgICAgICBjbGllbnRWZXJzaW9uOiBBLFxuICAgICAgICAgICAgdXJsOiBlbmNvZGVVUklDb21wb25lbnQobG9jYXRpb24uaHJlZilcbiAgICAgICAgfSwgRCA9IHt9LCBFID0ge19jb21wbGV0ZXM6IFtdfSwgRiA9IHtzdGF0ZTogMCwgZGF0YToge319O1xuICAgICAgICBuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIEIuaW5pdEVuZFRpbWUgPSBtKClcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBHID0gITEsIEggPSBbXSwgSSA9IHtcbiAgICAgICAgICAgIGNvbmZpZzogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBEID0gYSwgayhcImNvbmZpZ1wiLCBhKTtcbiAgICAgICAgICAgICAgICB2YXIgYiA9IEQuY2hlY2sgPT09ICExID8gITEgOiAhMDtcbiAgICAgICAgICAgICAgICBuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGIpYyhwLmNvbmZpZywge3ZlcmlmeUpzQXBpTGlzdDogaihELmpzQXBpTGlzdCl9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBFLl9jb21wbGV0ZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQi5wcmVWZXJpZnlFbmRUaW1lID0gbSgpLCBGLnN0YXRlID0gMSwgRi5kYXRhID0gYVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgRS5zdWNjZXNzID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDLmlzUHJlVmVyaWZ5T2sgPSAwXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBFLmZhaWwgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEUuX2ZhaWwgPyBFLl9mYWlsKGEpIDogRi5zdGF0ZSA9IC0xXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBFLl9jb21wbGV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5wdXNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBFLmNvbXBsZXRlID0gZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBjID0gMCwgZCA9IGEubGVuZ3RoOyBkID4gYzsgKytjKWFbY10oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBFLl9jb21wbGV0ZXMgPSBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgRVxuICAgICAgICAgICAgICAgICAgICB9KCkpLCBCLnByZVZlcmlmeVN0YXJ0VGltZSA9IG0oKTsgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBGLnN0YXRlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSBFLl9jb21wbGV0ZXMsIGQgPSAwLCBlID0gYS5sZW5ndGg7IGUgPiBkOyArK2QpYVtkXSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgRS5fY29tcGxldGVzID0gW11cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLCBELmJldGEgJiYgbygpXG4gICAgICAgICAgICB9LCByZWFkeTogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAwICE9IEYuc3RhdGUgPyBhKCkgOiAoRS5fY29tcGxldGVzLnB1c2goYSksICF4ICYmIEQuZGVidWcgJiYgYSgpKVxuICAgICAgICAgICAgfSwgZXJyb3I6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgXCI2LjAuMlwiID4gQSB8fCAoLTEgPT0gRi5zdGF0ZSA/IGEoRi5kYXRhKSA6IEUuX2ZhaWwgPSBhKVxuICAgICAgICAgICAgfSwgY2hlY2tKc0FwaTogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5jaGVja1Jlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyBpbiBiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHFbY107XG4gICAgICAgICAgICAgICAgICAgICAgICBkICYmIChiW2RdID0gYltjXSwgZGVsZXRlIGJbY10pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGMoXCJjaGVja0pzQXBpXCIsIHtqc0FwaUxpc3Q6IGooYS5qc0FwaUxpc3QpfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5fY29tcGxldGUgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGEuY2hlY2tSZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyAmJiAoYS5jaGVja1Jlc3VsdCA9IEpTT04ucGFyc2UoYykpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhID0gYihhKVxuICAgICAgICAgICAgICAgICAgICB9LCBhXG4gICAgICAgICAgICAgICAgfSgpKVxuICAgICAgICAgICAgfSwgb25NZW51U2hhcmVUaW1lbGluZTogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBkKHAub25NZW51U2hhcmVUaW1lbGluZSwge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYyhcInNoYXJlVGltZWxpbmVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBhLnRpdGxlIHx8IHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogYS50aXRsZSB8fCBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ191cmw6IGEuaW1nVXJsIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogYS5saW5rIHx8IGxvY2F0aW9uLmhyZWYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogYS50eXBlIHx8IFwibGlua1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfdXJsOiBhLmRhdGFVcmwgfHwgXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgYSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGEpXG4gICAgICAgICAgICB9LCBvbk1lbnVTaGFyZUFwcE1lc3NhZ2U6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgZChwLm9uTWVudVNoYXJlQXBwTWVzc2FnZSwge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYyhcInNlbmRBcHBNZXNzYWdlXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYS50aXRsZSB8fCBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6IGEuZGVzYyB8fCBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6IGEubGluayB8fCBsb2NhdGlvbi5ocmVmLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ191cmw6IGEuaW1nVXJsIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogYS50eXBlIHx8IFwibGlua1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfdXJsOiBhLmRhdGFVcmwgfHwgXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgYSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGEpXG4gICAgICAgICAgICB9LCBvbk1lbnVTaGFyZVFROiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGQocC5vbk1lbnVTaGFyZVFRLCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjKFwic2hhcmVRUVwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGEudGl0bGUgfHwgcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiBhLmRlc2MgfHwgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWdfdXJsOiBhLmltZ1VybCB8fCBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6IGEubGluayB8fCBsb2NhdGlvbi5ocmVmXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBhKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgYSlcbiAgICAgICAgICAgIH0sIG9uTWVudVNoYXJlV2VpYm86IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgZChwLm9uTWVudVNoYXJlV2VpYm8sIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGMoXCJzaGFyZVdlaWJvQXBwXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogYS50aXRsZSB8fCBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6IGEuZGVzYyB8fCBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ191cmw6IGEuaW1nVXJsIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogYS5saW5rIHx8IGxvY2F0aW9uLmhyZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGEpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBhKVxuICAgICAgICAgICAgfSwgb25NZW51U2hhcmVRWm9uZTogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBkKHAub25NZW51U2hhcmVRWm9uZSwge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYyhcInNoYXJlUVpvbmVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBhLnRpdGxlIHx8IHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogYS5kZXNjIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nX3VybDogYS5pbWdVcmwgfHwgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiBhLmxpbmsgfHwgbG9jYXRpb24uaHJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgYSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGEpXG4gICAgICAgICAgICB9LCBzdGFydFJlY29yZDogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBjKFwic3RhcnRSZWNvcmRcIiwge30sIGEpXG4gICAgICAgICAgICB9LCBzdG9wUmVjb3JkOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJzdG9wUmVjb3JkXCIsIHt9LCBhKVxuICAgICAgICAgICAgfSwgb25Wb2ljZVJlY29yZEVuZDogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBkKFwib25Wb2ljZVJlY29yZEVuZFwiLCBhKVxuICAgICAgICAgICAgfSwgcGxheVZvaWNlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJwbGF5Vm9pY2VcIiwge2xvY2FsSWQ6IGEubG9jYWxJZH0sIGEpXG4gICAgICAgICAgICB9LCBwYXVzZVZvaWNlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJwYXVzZVZvaWNlXCIsIHtsb2NhbElkOiBhLmxvY2FsSWR9LCBhKVxuICAgICAgICAgICAgfSwgc3RvcFZvaWNlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJzdG9wVm9pY2VcIiwge2xvY2FsSWQ6IGEubG9jYWxJZH0sIGEpXG4gICAgICAgICAgICB9LCBvblZvaWNlUGxheUVuZDogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBkKFwib25Wb2ljZVBsYXlFbmRcIiwgYSlcbiAgICAgICAgICAgIH0sIHVwbG9hZFZvaWNlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJ1cGxvYWRWb2ljZVwiLCB7bG9jYWxJZDogYS5sb2NhbElkLCBpc1Nob3dQcm9ncmVzc1RpcHM6IDAgPT0gYS5pc1Nob3dQcm9ncmVzc1RpcHMgPyAwIDogMX0sIGEpXG4gICAgICAgICAgICB9LCBkb3dubG9hZFZvaWNlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJkb3dubG9hZFZvaWNlXCIsIHtzZXJ2ZXJJZDogYS5zZXJ2ZXJJZCwgaXNTaG93UHJvZ3Jlc3NUaXBzOiAwID09IGEuaXNTaG93UHJvZ3Jlc3NUaXBzID8gMCA6IDF9LCBhKVxuICAgICAgICAgICAgfSwgdHJhbnNsYXRlVm9pY2U6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYyhcInRyYW5zbGF0ZVZvaWNlXCIsIHtsb2NhbElkOiBhLmxvY2FsSWQsIGlzU2hvd1Byb2dyZXNzVGlwczogMCA9PSBhLmlzU2hvd1Byb2dyZXNzVGlwcyA/IDAgOiAxfSwgYSlcbiAgICAgICAgICAgIH0sIGNob29zZUltYWdlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJjaG9vc2VJbWFnZVwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHNjZW5lOiBcIjF8MlwiLFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogYS5jb3VudCB8fCA5LFxuICAgICAgICAgICAgICAgICAgICBzaXplVHlwZTogYS5zaXplVHlwZSB8fCBbXCJvcmlnaW5hbFwiLCBcImNvbXByZXNzZWRcIl0sXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVR5cGU6IGEuc291cmNlVHlwZSB8fCBbXCJhbGJ1bVwiLCBcImNhbWVyYVwiXVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuX2NvbXBsZXRlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhLmxvY2FsSWRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgKGEubG9jYWxJZHMgPSBKU09OLnBhcnNlKGIpKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBhXG4gICAgICAgICAgICAgICAgfSgpKVxuICAgICAgICAgICAgfSwgZ2V0TG9jYXRpb246IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICB9LCBwcmV2aWV3SW1hZ2U6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYyhwLnByZXZpZXdJbWFnZSwge2N1cnJlbnQ6IGEuY3VycmVudCwgdXJsczogYS51cmxzfSwgYSlcbiAgICAgICAgICAgIH0sIHVwbG9hZEltYWdlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJ1cGxvYWRJbWFnZVwiLCB7bG9jYWxJZDogYS5sb2NhbElkLCBpc1Nob3dQcm9ncmVzc1RpcHM6IDAgPT0gYS5pc1Nob3dQcm9ncmVzc1RpcHMgPyAwIDogMX0sIGEpXG4gICAgICAgICAgICB9LCBkb3dubG9hZEltYWdlOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJkb3dubG9hZEltYWdlXCIsIHtzZXJ2ZXJJZDogYS5zZXJ2ZXJJZCwgaXNTaG93UHJvZ3Jlc3NUaXBzOiAwID09IGEuaXNTaG93UHJvZ3Jlc3NUaXBzID8gMCA6IDF9LCBhKVxuICAgICAgICAgICAgfSwgZ2V0TG9jYWxJbWdEYXRhOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIEcgPT09ICExID8gKEcgPSAhMCwgYyhcImdldExvY2FsSW1nRGF0YVwiLCB7bG9jYWxJZDogYS5sb2NhbElkfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5fY29tcGxldGUgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEcgPSAhMSwgSC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBILnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3guZ2V0TG9jYWxJbWdEYXRhKGIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIGFcbiAgICAgICAgICAgICAgICB9KCkpKSA6IEgucHVzaChhKVxuICAgICAgICAgICAgfSwgZ2V0TmV0d29ya1R5cGU6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGIgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGEuZXJyTXNnO1xuICAgICAgICAgICAgICAgICAgICBhLmVyck1zZyA9IFwiZ2V0TmV0d29ya1R5cGU6b2tcIjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhLnN1YnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZWxldGUgYS5zdWJ0eXBlLCBjKWEubmV0d29ya1R5cGUgPSBjOyBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gYi5pbmRleE9mKFwiOlwiKSwgZSA9IGIuc3Vic3RyaW5nKGQgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2VcIndpZmlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlXCJlZGdlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZVwid3dhblwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5ldHdvcmtUeXBlID0gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5lcnJNc2cgPSBcImdldE5ldHdvcmtUeXBlOmZhaWxcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjKFwiZ2V0TmV0d29ya1R5cGVcIiwge30sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuX2NvbXBsZXRlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBiKGEpXG4gICAgICAgICAgICAgICAgICAgIH0sIGFcbiAgICAgICAgICAgICAgICB9KCkpXG4gICAgICAgICAgICB9LCBvcGVuTG9jYXRpb246IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYyhcIm9wZW5Mb2NhdGlvblwiLCB7XG4gICAgICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBhLmxhdGl0dWRlLFxuICAgICAgICAgICAgICAgICAgICBsb25naXR1ZGU6IGEubG9uZ2l0dWRlLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBhLm5hbWUgfHwgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogYS5hZGRyZXNzIHx8IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlOiBhLnNjYWxlIHx8IDI4LFxuICAgICAgICAgICAgICAgICAgICBpbmZvVXJsOiBhLmluZm9VcmwgfHwgXCJcIlxuICAgICAgICAgICAgICAgIH0sIGEpXG4gICAgICAgICAgICB9LCBnZXRMb2NhdGlvbjogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBhID0gYSB8fCB7fSwgYyhwLmdldExvY2F0aW9uLCB7dHlwZTogYS50eXBlIHx8IFwid2dzODRcIn0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuX2NvbXBsZXRlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBhLnR5cGVcbiAgICAgICAgICAgICAgICAgICAgfSwgYVxuICAgICAgICAgICAgICAgIH0oKSlcbiAgICAgICAgICAgIH0sIGhpZGVPcHRpb25NZW51OiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJoaWRlT3B0aW9uTWVudVwiLCB7fSwgYSlcbiAgICAgICAgICAgIH0sIHNob3dPcHRpb25NZW51OiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJzaG93T3B0aW9uTWVudVwiLCB7fSwgYSlcbiAgICAgICAgICAgIH0sIGNsb3NlV2luZG93OiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGEgPSBhIHx8IHt9LCBjKFwiY2xvc2VXaW5kb3dcIiwge30sIGEpXG4gICAgICAgICAgICB9LCBoaWRlTWVudUl0ZW1zOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJoaWRlTWVudUl0ZW1zXCIsIHttZW51TGlzdDogYS5tZW51TGlzdH0sIGEpXG4gICAgICAgICAgICB9LCBzaG93TWVudUl0ZW1zOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJzaG93TWVudUl0ZW1zXCIsIHttZW51TGlzdDogYS5tZW51TGlzdH0sIGEpXG4gICAgICAgICAgICB9LCBoaWRlQWxsTm9uQmFzZU1lbnVJdGVtOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJoaWRlQWxsTm9uQmFzZU1lbnVJdGVtXCIsIHt9LCBhKVxuICAgICAgICAgICAgfSwgc2hvd0FsbE5vbkJhc2VNZW51SXRlbTogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBjKFwic2hvd0FsbE5vbkJhc2VNZW51SXRlbVwiLCB7fSwgYSlcbiAgICAgICAgICAgIH0sIHNjYW5RUkNvZGU6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYSA9IGEgfHwge30sIGMoXCJzY2FuUVJDb2RlXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgbmVlZFJlc3VsdDogYS5uZWVkUmVzdWx0IHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIHNjYW5UeXBlOiBhLnNjYW5UeXBlIHx8IFtcInFyQ29kZVwiLCBcImJhckNvZGVcIl1cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLl9jb21wbGV0ZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5yZXN1bHRTdHI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBKU09OLnBhcnNlKGIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlc3VsdFN0ciA9IGMgJiYgYy5zY2FuX2NvZGUgJiYgYy5zY2FuX2NvZGUuc2Nhbl9yZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIGFcbiAgICAgICAgICAgICAgICB9KCkpXG4gICAgICAgICAgICB9LCBvcGVuQWRkcmVzczogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBjKHAub3BlbkFkZHJlc3MsIHt9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhLl9jb21wbGV0ZSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhID0gZyhhKVxuICAgICAgICAgICAgICAgICAgICB9LCBhXG4gICAgICAgICAgICAgICAgfSgpKVxuICAgICAgICAgICAgfSwgb3BlblByb2R1Y3RTcGVjaWZpY1ZpZXc6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYyhwLm9wZW5Qcm9kdWN0U3BlY2lmaWNWaWV3LCB7cGlkOiBhLnByb2R1Y3RJZCwgdmlld190eXBlOiBhLnZpZXdUeXBlIHx8IDAsIGV4dF9pbmZvOiBhLmV4dEluZm99LCBhKVxuICAgICAgICAgICAgfSwgYWRkQ2FyZDogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBiID0gYS5jYXJkTGlzdCwgZCA9IFtdLCBlID0gMCwgZiA9IGIubGVuZ3RoOyBmID4gZTsgKytlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnID0gYltlXSwgaCA9IHtjYXJkX2lkOiBnLmNhcmRJZCwgY2FyZF9leHQ6IGcuY2FyZEV4dH07XG4gICAgICAgICAgICAgICAgICAgIGQucHVzaChoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjKHAuYWRkQ2FyZCwge2NhcmRfbGlzdDogZH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuX2NvbXBsZXRlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYS5jYXJkX2xpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBKU09OLnBhcnNlKGIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwLCBkID0gYi5sZW5ndGg7IGQgPiBjOyArK2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBiW2NdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmNhcmRJZCA9IGUuY2FyZF9pZCwgZS5jYXJkRXh0ID0gZS5jYXJkX2V4dCwgZS5pc1N1Y2Nlc3MgPSBlLmlzX3N1Y2MgPyAhMCA6ICExLCBkZWxldGUgZS5jYXJkX2lkLCBkZWxldGUgZS5jYXJkX2V4dCwgZGVsZXRlIGUuaXNfc3VjY1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmNhcmRMaXN0ID0gYiwgZGVsZXRlIGEuY2FyZF9saXN0XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIGFcbiAgICAgICAgICAgICAgICB9KCkpXG4gICAgICAgICAgICB9LCBjaG9vc2VDYXJkOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMoXCJjaG9vc2VDYXJkXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgYXBwX2lkOiBELmFwcElkLFxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbl9pZDogYS5zaG9wSWQgfHwgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgc2lnbl90eXBlOiBhLnNpZ25UeXBlIHx8IFwiU0hBMVwiLFxuICAgICAgICAgICAgICAgICAgICBjYXJkX2lkOiBhLmNhcmRJZCB8fCBcIlwiLFxuICAgICAgICAgICAgICAgICAgICBjYXJkX3R5cGU6IGEuY2FyZFR5cGUgfHwgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgY2FyZF9zaWduOiBhLmNhcmRTaWduLFxuICAgICAgICAgICAgICAgICAgICB0aW1lX3N0YW1wOiBhLnRpbWVzdGFtcCArIFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIG5vbmNlX3N0cjogYS5ub25jZVN0clxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuX2NvbXBsZXRlID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEuY2FyZExpc3QgPSBhLmNob29zZV9jYXJkX2luZm8sIGRlbGV0ZSBhLmNob29zZV9jYXJkX2luZm9cbiAgICAgICAgICAgICAgICAgICAgfSwgYVxuICAgICAgICAgICAgICAgIH0oKSlcbiAgICAgICAgICAgIH0sIG9wZW5DYXJkOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSBhLmNhcmRMaXN0LCBkID0gW10sIGUgPSAwLCBmID0gYi5sZW5ndGg7IGYgPiBlOyArK2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGcgPSBiW2VdLCBoID0ge2NhcmRfaWQ6IGcuY2FyZElkLCBjb2RlOiBnLmNvZGV9O1xuICAgICAgICAgICAgICAgICAgICBkLnB1c2goaClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYyhwLm9wZW5DYXJkLCB7Y2FyZF9saXN0OiBkfSwgYSlcbiAgICAgICAgICAgIH0sIGNvbnN1bWVBbmRTaGFyZUNhcmQ6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYyhwLmNvbnN1bWVBbmRTaGFyZUNhcmQsIHtjb25zdW1lZENhcmRJZDogYS5jYXJkSWQsIGNvbnN1bWVkQ29kZTogYS5jb2RlfSwgYSlcbiAgICAgICAgICAgIH0sIGNob29zZVdYUGF5OiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMocC5jaG9vc2VXWFBheSwgZihhKSwgYSlcbiAgICAgICAgICAgIH0sIG9wZW5FbnRlcnByaXNlUmVkUGFja2V0OiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGMocC5vcGVuRW50ZXJwcmlzZVJlZFBhY2tldCwgZihhKSwgYSlcbiAgICAgICAgICAgIH0sIHN0YXJ0U2VhcmNoQmVhY29uczogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBjKHAuc3RhcnRTZWFyY2hCZWFjb25zLCB7dGlja2V0OiBhLnRpY2tldH0sIGEpXG4gICAgICAgICAgICB9LCBzdG9wU2VhcmNoQmVhY29uczogZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICBjKHAuc3RvcFNlYXJjaEJlYWNvbnMsIHt9LCBhKVxuICAgICAgICAgICAgfSwgb25TZWFyY2hCZWFjb25zOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgIGQocC5vblNlYXJjaEJlYWNvbnMsIGEpXG4gICAgICAgICAgICB9LCBvcGVuRW50ZXJwcmlzZUNoYXQ6IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgYyhcIm9wZW5FbnRlcnByaXNlQ2hhdFwiLCB7dXNlcmlkbGlzdDogYS51c2VySWRzLCBjaGF0bmFtZTogYS5ncm91cE5hbWV9LCBhKVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCBKID0gMSwgSyA9IHt9O1xuICAgICAgICByZXR1cm4gci5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGlmICgheSkge1xuICAgICAgICAgICAgICAgIHZhciBiID0gYS50YXJnZXQsIGMgPSBiLnRhZ05hbWUsIGQgPSBiLnNyYztcbiAgICAgICAgICAgICAgICBpZiAoXCJJTUdcIiA9PSBjIHx8IFwiVklERU9cIiA9PSBjIHx8IFwiQVVESU9cIiA9PSBjIHx8IFwiU09VUkNFXCIgPT0gYykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IC0xICE9IGQuaW5kZXhPZihcInd4bG9jYWxyZXNvdXJjZTovL1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGEucHJldmVudERlZmF1bHQoKSwgYS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gYltcInd4LWlkXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYgfHwgKGYgPSBKKyssIGJbXCJ3eC1pZFwiXSA9IGYpLCBLW2ZdKXJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIEtbZl0gPSAhMCwgd3guZ2V0TG9jYWxJbWdEYXRhKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbElkOiBkLCBzdWNjZXNzOiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnNyYyA9IGEubG9jYWxEYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgITApLCByLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICBpZiAoIXkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYiA9IGEudGFyZ2V0LCBjID0gYi50YWdOYW1lO1xuICAgICAgICAgICAgICAgIGIuc3JjO1xuICAgICAgICAgICAgICAgIGlmIChcIklNR1wiID09IGMgfHwgXCJWSURFT1wiID09IGMgfHwgXCJBVURJT1wiID09IGMgfHwgXCJTT1VSQ0VcIiA9PSBjKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gYltcInd4LWlkXCJdO1xuICAgICAgICAgICAgICAgICAgICBkICYmIChLW2RdID0gITEpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCAhMCksIGIgJiYgKGEud3ggPSBhLmpXZWl4aW4gPSBJKSwgSVxuICAgIH1cbn0pO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL193ZWl4aW4tanMtc2RrQDEuMi4wQHdlaXhpbi1qcy1zZGsvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHd4IGZyb20gJy4vcHJvbWlzaWZ5J1xuaW1wb3J0IHJlZ2lzdGVyIGZyb20gJy4vcmVnaXN0ZXInXG5cbnd4LnJlZ2lzdGVyID0gcmVnaXN0ZXJcbm1vZHVsZS5leHBvcnRzID0gd3hcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsImltcG9ydCB3eCBmcm9tICd3ZWl4aW4tanMtc2RrJ1xuaW1wb3J0IHsgYXN5bmNMaXN0LCBzeW5jTGlzdH0gZnJvbSAnLi9hcGlMaXN0J1xuaW1wb3J0ICogYXMgaG9vayBmcm9tICcuL2hvb2snXG5pbXBvcnQge2luV1gsIGxvZ30gZnJvbSAnLi91dGlscydcblxuY29uc3QgcHJvbWlzaWZ5ID0gKG9iaiwgbWV0aG9kLCBzeW5jKSA9PiB7XG4gIGNvbnN0IG9yaWdpbiA9IG9ialttZXRob2RdLmJpbmQob2JqKVxuICBvYmpbbWV0aG9kXSA9IGZ1bmN0aW9uKHtzdWNjZXNzLCBmYWlsLCAuLi5vdGhlckFyZ3N9ID0ge30pIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYoIWluV1gpIHJldHVybiBsb2coJ25vdCBpbiB3ZWl4aW4nKSAmJiByZXNvbHZlKHtlcnJNc2c6ICdub3QgaW4gd2VpeGluJ30pO1xuXG4gICAgICB3eC5yZWFkeSgoKSA9PiB7XG4gICAgICAgIGlmKGhvb2tbbWV0aG9kXSkgb3RoZXJBcmdzID0gaG9va1ttZXRob2RdKHsuLi5vdGhlckFyZ3N9KTtcbiAgICAgICAgaWYoc3luYykgcmV0dXJuIHJlc29sdmUob3JpZ2luKHsuLi5vdGhlckFyZ3N9KSk7XG5cbiAgICAgICAgb3JpZ2luKHtcbiAgICAgICAgICAuLi5vdGhlckFyZ3MsXG4gICAgICAgICAgc3VjY2VzczogKC4uLmFyZ3MpID0+IHtcbiAgICAgICAgICAgIGlmKHN1Y2Nlc3MpIHN1Y2Nlc3MoLi4uYXJncylcbiAgICAgICAgICAgIHJlc29sdmUoLi4uYXJncylcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZhaWw6ICguLi5hcmdzKSA9PiB7XG4gICAgICAgICAgICBpZihmYWlsKSBmYWlsKC4uLmFyZ3MpXG4gICAgICAgICAgICByZWplY3QoLi4uYXJncylcbiAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuICB9XG59XG5cbmFzeW5jTGlzdC5mb3JFYWNoKGtleSA9PiBwcm9taXNpZnkod3gsIGtleSkpXG5zeW5jTGlzdC5mb3JFYWNoKGtleSA9PiBwcm9taXNpZnkod3gsIGtleSwgdHJ1ZSkpXG5cbmV4cG9ydCBkZWZhdWx0IHd4XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvcHJvbWlzaWZ5LmpzIiwiZXhwb3J0IGNvbnN0IGFzeW5jTGlzdCA9IFtcbiAgJ2NoZWNrSnNBcGknLFxuICAnb3BlbkVudGVycHJpc2VDaGF0JyxcbiAgJ29uTWVudVNoYXJlQXBwTWVzc2FnZScsXG4gIC8vIGpzLXNkayDkuK3ml6DmraTmlrnms5VcbiAgLy8gJ29uTWVudVNoYXJlV2VjaGF0JyxcbiAgJ2Nob29zZUltYWdlJyxcbiAgJ3VwbG9hZEltYWdlJyxcbiAgJ2Rvd25sb2FkSW1hZ2UnLFxuICAnc3RvcFJlY29yZCcsXG4gICdvblZvaWNlUGxheUVuZCcsXG4gICd1cGxvYWRWb2ljZScsXG4gICdkb3dubG9hZFZvaWNlJyxcbiAgJ2dldE5ldHdvcmtUeXBlJyxcbiAgJ2dldExvY2F0aW9uJyxcbiAgJ3NjYW5RUkNvZGUnLFxuXVxuXG4vLyBleHBvcnQgY29uc3QgYXN5bmNDb21wbGV0ZUxpc3QgPSBbJ29uVm9pY2VSZWNvcmRFbmQnXVxuXG5leHBvcnQgY29uc3Qgc3luY0xpc3QgPSBbXG4gICdvblZvaWNlUmVjb3JkRW5kJyxcbiAgLy8gJ3NlbGVjdEVudGVycHJpc2VDb250YWN0JyxcbiAgJ3N0YXJ0UmVjb3JkJyxcbiAgJ3BsYXlWb2ljZScsXG4gICdwYXVzZVZvaWNlJyxcbiAgJ3N0b3BWb2ljZScsXG4gICdwcmV2aWV3SW1hZ2UnLFxuICAvLyAncHJldmlld0ZpbGUnLFxuICAnb3BlbkxvY2F0aW9uJyxcbiAgLy8gJ29uSGlzdG9yeUJhY2snLFxuICAnaGlkZU9wdGlvbk1lbnUnLFxuICAnc2hvd09wdGlvbk1lbnUnLFxuICAnaGlkZU1lbnVJdGVtcycsXG4gICdzaG93TWVudUl0ZW1zJyxcbiAgJ2hpZGVBbGxOb25CYXNlTWVudUl0ZW0nLFxuICAnc2hvd0FsbE5vbkJhc2VNZW51SXRlbScsXG4gICdjbG9zZVdpbmRvdycsXG4gIC8vICdjaG9vc2VJbnZvaWNlJ1xuXVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2FwaUxpc3QuanMiLCIvLyDlm77niYfpooTop4jlj6rmjqXlj5dodHRw55qEdXJs6ZO+5o6lW+ingeW+ruS/oeWumOaWuUFQSV1cbmV4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2UgPSAoe2N1cnJlbnQsIHVybHN9KSA9PiB7XG4gIGNvbnN0IHRvSHR0cCA9ICh1cmwpID0+IHVybC5yZXBsYWNlKC9eaHR0cHMqLywgJ2h0dHAnKVxuICByZXR1cm4ge2N1cnJlbnQ6IHRvSHR0cChjdXJyZW50KSwgdXJsczogdXJscy5tYXAodG9IdHRwKX1cbn1cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaG9vay5qcyIsImltcG9ydCB3eCBmcm9tICd3ZWl4aW4tanMtc2RrJ1xuaW1wb3J0IHtsb2csIGdldFJlcXVlc3QsIGluV1h9IGZyb20gJy4vdXRpbHMnXG5cbi8vIOazqOWGjOetvuWQjVxuZXhwb3J0IGRlZmF1bHQgKHthcHBpZCwgc2lnbmF0dXJlVXJsLCBkZWJ1ZyA9IGZhbHNlLCBqc0FwaUxpc3R9KSA9PiB7XG4gIGlmKCEoYXBwaWQgfHwgc2lnbmF0dXJlVXJsKSkgcmV0dXJuIGxvZygnaW52YWxpZCBwYXJhbXMhIGFwcGlkLCBzaWduYXR1cmVVcmwgc2hvdWxkIGhhdmUgdmFsdWUnKTtcbiAgLy8gaWYoIWluV1gpIHJldHVybiBsb2coJ25vdCBpbiB3ZWl4aW4nKTtcblxuICBnZXRSZXF1ZXN0KHNpZ25hdHVyZVVybCkudGhlbigoe2RhdGEsIGNvZGV9KSA9PiB7XG4gICAgaWYoY29kZSAhPSAwKSByZXR1cm4gbG9nKCdnZXQgc2lnbmF0dXJlIGVycm9yIScpO1xuICAgIGNvbnN0IHt0aW1lc3RhbXAsIG5vbmNlU3RyLCBzaWduYXR1cmV9ID0gZGF0YVxuICAgIHd4LmNvbmZpZyh7XG4gICAgICBiZXRhOiB0cnVlLC8vIOW/hemhu+i/meS5iOWGme+8jOWQpuWImeWcqOW+ruS/oeaPkuS7tuacieS6m2pzYXBp5Lya5pyJ6Zeu6aKYXG4gICAgICBkZWJ1ZywgLy8g5byA5ZCv6LCD6K+V5qih5byPLOiwg+eUqOeahOaJgOaciWFwaeeahOi/lOWbnuWAvOS8muWcqOWuouaIt+err2FsZXJ05Ye65p2l77yMXG4gICAgICAvLyDoi6XopoHmn6XnnIvkvKDlhaXnmoTlj4LmlbDvvIzlj6/ku6XlnKhwY+err+aJk+W8gO+8jOWPguaVsOS/oeaBr+S8mumAmui/h2xvZ+aJk+WHuu+8jOS7heWcqHBj56uv5pe25omN5Lya5omT5Y2w44CCXG4gICAgICBhcHBJZDogYXBwaWQsIC8vIOW/heWhq++8jOS8geS4muW+ruS/oeeahGNyb3BJRFxuICAgICAgdGltZXN0YW1wLCAvLyDlv4XloavvvIznlJ/miJDnrb7lkI3nmoTml7bpl7TmiLNcbiAgICAgIG5vbmNlU3RyLCAvLyDlv4XloavvvIznlJ/miJDnrb7lkI3nmoTpmo/mnLrkuLJcbiAgICAgIHNpZ25hdHVyZSwvLyDlv4XloavvvIznrb7lkI3vvIzop4Fb6ZmE5b2VMV0oIzExOTc0KVxuICAgICAganNBcGlMaXN0ICAvLyDlv4XloavvvIzpnIDopoHkvb/nlKjnmoRKU+aOpeWPo+WIl+ihqO+8jOaJgOaciUpT5o6l5Y+j5YiX6KGo6KeB6ZmE5b2VMlxuICAgIH0pO1xuICB9KVxufVxuXG4vLyBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBkb2N1bWVudC50aXRsZSwgbG9jYXRpb24uaHJlZi5yZXBsYWNlKC9bP3wmXWNvZGU9XFx3Ky9nLCAnJykpXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9wc3RhdGUnLCAoKSA9PiB7XG4vLyAgIGNvbnNvbGUubG9nKCdwb3BzdGF0ZSBjaGFuZ2U6ICcsIGFyZ3VtZW50cylcbi8vIH0pXG5cbi8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXBsYWNlU3RhdGUnLCAoKSA9PiB7XG4vLyAgIGNvbnNvbGUubG9nKCdyZXBsYWNlc3RhdGUgY2hhbmdlOiAnLCBhcmd1bWVudHMpXG4vLyB9KVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9yZWdpc3Rlci5qcyIsIlxuZXhwb3J0IGNvbnN0IGluV1ggPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goJ21pY3JvbWVzc2VuZ2VyJylcblxuZXhwb3J0IGNvbnN0IGxvZyA9IChtc2csIHR5cGU9J2Vycm9yJykgPT4gY29uc29sZVt0eXBlXSgnd3gtc2RrLXByb21pc2U6ICcsIG1zZylcblxuZXhwb3J0IGNvbnN0IGdldFJlcXVlc3QgPSAodXJsLCBwYXJhbXMpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICB2YXIgeG1sSHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh4bWxIdHRwLnJlYWR5U3RhdGUgPT0gNCAmJiB4bWxIdHRwLnN0YXR1cyA9PSAyMDAgKXtcbiAgICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UoeG1sSHR0cC5yZXNwb25zZVRleHQpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgeG1sSHR0cC5vcGVuKFwiR0VUXCIsIHVybCwgdHJ1ZSk7IC8vIHRydWUgZm9yIGFzeW5jaHJvbm91c1xuICAgIHhtbEh0dHAuc2VuZChudWxsKTtcbiAgfSlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy5qcyJdLCJzb3VyY2VSb290IjoiIn0=